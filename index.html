<!DOCTYPE html>
<html lang="en">

<head>
    <title>Leed Price Calculator</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    </head>
    <script>
  function print_country(country_id){
    // given the id of the <select> tag as function argument, it inserts <option> tags
   $("#country-icon").replaceWith("<i id=\"country-icon-dynamic\" class=\"fa fa-refresh fa-pulse\"></i>");

    $.getJSON('https://leedonline-api.usgbc.org/v1/Common/getCountriesAndStates.json', function(data) {
    var option_str = document.getElementById(country_id);
    option_str.length=0;
    option_str.options[0] = new Option('Select Country','');
    option_str.selectedIndex = 0;
    var countries = data.countries;
    var printCountries = Object.keys(countries);
    printCountries.forEach(function(key){
        option_str.options[option_str.length] = new Option(countries[key],key);
       });
    $("#country-icon-dynamic").replaceWith("<i id=\"country-icon\" class=\"fa fa-globe\"></i>");
    });
}

function print_state(state_id, country_index){
   
   $("#country-icon").replaceWith("<i id=\"country-icon-dynamic\" class=\"fa fa-refresh fa-pulse\"></i>");

    $.getJSON('https://leedonline-api.usgbc.org/v1/Common/getCountriesAndStates.json', function(data) {
    var option_str = document.getElementById(state_id);
    option_str.length=0;
    option_str.options[0] = new Option('Select State','');
    option_str.selectedIndex = 0;
    if(data.divisions[country_index] != undefined){
      $("#state-option").removeClass("hidden").addClass("visible");
      $('#state').prop('required',true);
      var states = data.divisions[country_index];
      var printStates = Object.keys(states);
      printStates.forEach(function(key){
        option_str.options[option_str.length] = new Option(states[key],key);
       });
      }
      else{
        $("#state-option").removeClass("visible").addClass("hidden");
        $("#state").removeAttr("required");
      }
    $("#country-icon-dynamic").replaceWith("<i id=\"country-icon\" class=\"fa fa-globe\"></i>");
    });

}
    </script>
<body>
    <div class="text-center">
        <h1>LEED PRICING CALCULATOR</h1>
        <br>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-md-offset-3 col-sm-6 col-sm-offset-3 col-xs-10 col-xs-offset-1">
                <div class="panel panel-primary">
                    <div class="panel-heading"> <strong> Leed Pricing Estimate </strong> </div>
                    <div class="panel-body">
                        <form name="form" id="leedprice" action="javascript:void(0)" method="post" role="form">
                            <br>
                       
                            <div class="form-group input-group"> 
                            <span class="input-group-addon"><i id="country-icon" class="fa fa-globe"></i></span>
                                <select class="form-control" onchange="print_state('state',this.options[this.selectedIndex].value);" id="country" name="country" required></select>
                                 <script language="javascript">
                                    print_country("country");
                                </script>
                            </div>

                            <div id="state-option" class="form-group input-group hidden"> 
                            <span class="input-group-addon"><i class="fa fa-globe"></i></span>
                                <select class="form-control" name="state" id="state"></select>
                               
                            </div>

                            <div class="form-group input-group"> 
                            <span class="input-group-addon"><i class="fa fa-star" aria-hidden="true"></i></span>
                             <input type="text" id="ratingSystem" value="" name="ratingSystem" class="form-control" placeholder="Enter Rating System Group" required> 
                            </div>

                             <div class="form-group input-group">
                              <span class="input-group-addon"><i class="fa fa-file-text" aria-hidden="true"></i></span>
                              <select class="form-control" id="type" name="type" required>
                              <option value="">Select Type</option>
                              <option value="rate">Registration</option>
                              <option value="designRate">Design Review</option>
                              <option value="constRate">Construction Review</option>
                              </select>
                            </div>

                            <div class="form-group input-group"> 
                            <span class="input-group-addon"><i class="fa fa-object-group" aria-hidden="true"></i></span>
                             <input type="text" id="givenArea" value="" name="givenArea" class="form-control" placeholder="Enter Area in Sq.Ft." required> 
                            </div>

                            <div class="form-group input-group">
                                <button class="btn btn-primary" type="submit" name="submit">
                                <i class="fa fa-calculator" aria-hidden="true"></i> Calculate</button>
                                <input type="hidden" name="action" value="1"> </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>